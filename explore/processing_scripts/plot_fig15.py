import matplotlib.pyplot as plt
import numpy as np 
from scipy.interpolate import interp1d


#NOTE: Paste here the result of calling >>collect.py<<, as >>res_dict<<.
#All results obtained at the time of preparing the camera-ready version of the paper are kept here,
#including results for all three placement seeds, generated to inspect the robustness of the observations.
#While there were some shifts, all general trends were maintained across different placement seeds.

#Max seed:
#res_dict = {'5': {8: {'wires': {153: {'index': 5, 'td': 1.29094856038}, 156: {'index': 6, 'td': 1.28366817939}, 54: {'index': 7, 'td': 1.29385096999}}, 'avg': 1.2876582887622132}, 16: {'wires': {153: {'index': 5, 'td': 1.49341967908}, 156: {'index': 6, 'td': 1.56718143797}, 54: {'index': 7, 'td': 1.55534847235}}, 'avg': 1.5424762966552794}, 2: {'wires': {153: {'index': 5, 'td': 1.3121074398}, 156: {'index': 6, 'td': 1.27468240326}, 54: {'index': 7, 'td': 1.32096420892}}, 'avg': 1.300641153591249}, 4: {'wires': {153: {'index': 5, 'td': 1.27245378944}, 156: {'index': 6, 'td': 1.2469201498}, 54: {'index': 7, 'td': 1.25848250633}}, 'avg': 1.2585263683974388}}, '3.0': {8: {'wires': {15: {'index': 3, 'td': 1.59082608305}, 14: {'index': 4, 'td': 1.63427100195}, 47: {'index': 1, 'td': 1.54279144929}}, 'avg': 1.587091651410469}, 16: {'wires': {15: {'index': 3, 'td': 2.20678368948}, 14: {'index': 4, 'td': 2.36373491274}, 47: {'index': 1, 'td': 2.2621411185}}, 'avg': 2.268353767575175}, 2: {'wires': {15: {'index': 3, 'td': 1.49649037963}, 14: {'index': 4, 'td': 1.53355555763}, 47: {'index': 1, 'td': 1.51380275998}}, 'avg': 1.5085599473744704}, 4: {'wires': {47: {'index': 1, 'td': 1.44251135855}, 14: {'index': 4, 'td': 1.49283968758}, 15: {'index': 3, 'td': 1.48952391486}}, 'avg': 1.4803902409948517}}, '7': {8: {'wires': {56: {'index': 5, 'td': 1.37988047494}, 164: {'index': 4, 'td': 1.36978434829}, 55: {'index': 3, 'td': 1.38587783809}}, 'avg': 1.376724009400434}, 16: {'wires': {56: {'index': 5, 'td': 1.68352955177}, 164: {'index': 4, 'td': 1.60272163929}, 55: {'index': 3, 'td': 1.60607227386}}, 'avg': 1.6238944807572144}, 2: {'wires': {56: {'index': 5, 'td': 1.37887788518}, 164: {'index': 4, 'td': 1.41274077286}, 55: {'index': 3, 'td': 1.47949959245}}, 'avg': 1.4198048886574477}, 4: {'wires': {56: {'index': 5, 'td': 1.3547531158}, 164: {'index': 4, 'td': 1.34149707614}, 55: {'index': 3, 'td': 1.36311233205}}, 'avg': 1.3545954270679375}}, '16': {8: {'wires': {249: {'index': 2, 'td': 1.72750658981}, 155: {'index': 3, 'td': 1.7149060933}, 78: {'index': 1, 'td': 1.68639068245}}, 'avg': 1.71404182891408}, 16: {'wires': {249: {'index': 2, 'td': 1.87793378527}, 155: {'index': 3, 'td': 1.87714130487}, 78: {'index': 1, 'td': 1.87059797726}}, 'avg': 1.87246582273326}, 2: {'wires': {249: {'index': 2, 'td': 1.72184606571}, 155: {'index': 3, 'td': 1.7562026838}, 78: {'index': 1, 'td': 1.72638655983}}, 'avg': 1.7341571351946485}, 4: {'wires': {249: {'index': 2, 'td': 1.70484988002}, 155: {'index': 3, 'td': 1.73176788023}, 78: {'index': 1, 'td': 1.69582440011}}, 'avg': 1.7080924912229407}}, '3.1': {8: {'wires': {50: {'index': 8, 'td': 1.29414414252}, 46: {'index': 5, 'td': 1.26904914667}, 54: {'index': 2, 'td': 1.2705860023}}, 'avg': 1.2754473806261706}, 16: {'wires': {50: {'index': 8, 'td': 1.75659878387}, 54: {'index': 2, 'td': 1.75308428001}, 46: {'index': 5, 'td': 1.792859868}}, 'avg': 1.7701276518145057}, 2: {'wires': {50: {'index': 8, 'td': 1.24172577732}, 54: {'index': 2, 'td': 1.22262646701}, 46: {'index': 5, 'td': 1.23027756284}}, 'avg': 1.2273662057798012}, 4: {'wires': {50: {'index': 8, 'td': 1.21671100026}, 46: {'index': 5, 'td': 1.19828023359}, 54: {'index': 2, 'td': 1.18854633101}}, 'avg': 1.201863273976583}}, '4': {8: {'wires': {15: {'index': 2, 'td': 1.55249604079}, 47: {'index': 1, 'td': 1.50360651523}, 31: {'index': 3, 'td': 1.57327979968}}, 'avg': 1.540857406375392}, 16: {'wires': {15: {'index': 2, 'td': 1.97910779868}, 31: {'index': 3, 'td': 2.05523085677}, 47: {'index': 1, 'td': 1.97108216217}}, 'avg': 1.987795772419929}, 2: {'wires': {31: {'index': 3, 'td': 1.51220862621}, 47: {'index': 1, 'td': 1.47061490631}, 15: {'index': 2, 'td': 1.53265288058}}, 'avg': 1.5040470648524593}, 4: {'wires': {47: {'index': 1, 'td': 1.42252941145}, 31: {'index': 3, 'td': 1.48922271985}, 15: {'index': 2, 'td': 1.45573588959}}, 'avg': 1.4466108622561402}}}


#Min seed:
#res_dict = {'5': {8: {'wires': {153: {'index': 5, 'td': 1.22924510071}, 156: {'index': 6, 'td': 1.23929885046}, 54: {'index': 7, 'td': 1.23187934939}}, 'avg': 1.2302419773370412}, 16: {'wires': {153: {'index': 5, 'td': 1.442243194}, 156: {'index': 6, 'td': 1.51000541377}, 54: {'index': 7, 'td': 1.47965645557}}, 'avg': 1.476039773835384}, 2: {'wires': {153: {'index': 5, 'td': 1.24949026873}, 156: {'index': 6, 'td': 1.22274891106}, 54: {'index': 7, 'td': 1.24679135185}}, 'avg': 1.2399696518304135}, 4: {'wires': {153: {'index': 5, 'td': 1.21623196576}, 156: {'index': 6, 'td': 1.20487504141}, 54: {'index': 7, 'td': 1.21710674281}}, 'avg': 1.2135148181916477}}, '3.0': {8: {'wires': {15: {'index': 3, 'td': 1.53381917511}, 14: {'index': 4, 'td': 1.5505055627}, 47: {'index': 1, 'td': 1.48822822907}}, 'avg': 1.5243951264280244}, 16: {'wires': {15: {'index': 3, 'td': 2.12182904308}, 14: {'index': 4, 'td': 2.26524005452}, 47: {'index': 1, 'td': 2.16451732074}}, 'avg': 2.17079956121295}, 2: {'wires': {15: {'index': 3, 'td': 1.42106682554}, 14: {'index': 4, 'td': 1.46547602474}, 47: {'index': 1, 'td': 1.41949557468}}, 'avg': 1.4333320569567867}, 4: {'wires': {47: {'index': 1, 'td': 1.37363667258}, 14: {'index': 4, 'td': 1.42243533353}, 15: {'index': 3, 'td': 1.42074188237}}, 'avg': 1.4069054980507283}}, '7': {8: {'wires': {56: {'index': 5, 'td': 1.32500999185}, 164: {'index': 4, 'td': 1.31509340581}, 55: {'index': 3, 'td': 1.32153348397}}, 'avg': 1.3224485499253835}, 16: {'wires': {56: {'index': 5, 'td': 1.60603291376}, 164: {'index': 4, 'td': 1.52657016907}, 55: {'index': 3, 'td': 1.52640970757}}, 'avg': 1.5457059464325849}, 2: {'wires': {56: {'index': 5, 'td': 1.30700742923}, 164: {'index': 4, 'td': 1.33114930485}, 55: {'index': 3, 'td': 1.39154925442}}, 'avg': 1.3387992042346852}, 4: {'wires': {56: {'index': 5, 'td': 1.28812803553}, 164: {'index': 4, 'td': 1.2926991438}, 55: {'index': 3, 'td': 1.30872600497}}, 'avg': 1.2929655188538676}}, '16': {8: {'wires': {249: {'index': 2, 'td': 1.65509354877}, 155: {'index': 3, 'td': 1.66186362346}, 78: {'index': 1, 'td': 1.63449483035}}, 'avg': 1.6580704548241207}, 16: {'wires': {249: {'index': 2, 'td': 1.80713212227}, 155: {'index': 3, 'td': 1.79500119994}, 78: {'index': 1, 'td': 1.78090752531}}, 'avg': 1.7921007091970866}, 2: {'wires': {249: {'index': 2, 'td': 1.66152666428}, 155: {'index': 3, 'td': 1.69189839372}, 78: {'index': 1, 'td': 1.64172108756}}, 'avg': 1.6696838208870466}, 4: {'wires': {249: {'index': 2, 'td': 1.63471345116}, 155: {'index': 3, 'td': 1.66066467719}, 78: {'index': 1, 'td': 1.62583363749}}, 'avg': 1.6436116032183214}}, '3.1': {8: {'wires': {50: {'index': 8, 'td': 1.25371283516}, 46: {'index': 5, 'td': 1.22589895289}, 54: {'index': 2, 'td': 1.23266879026}}, 'avg': 1.2364100381597336}, 16: {'wires': {50: {'index': 8, 'td': 1.69153767239}, 54: {'index': 2, 'td': 1.69058182346}, 46: {'index': 5, 'td': 1.71733251021}}, 'avg': 1.6993460370043318}, 2: {'wires': {50: {'index': 8, 'td': 1.19217127297}, 54: {'index': 2, 'td': 1.16039018773}, 46: {'index': 5, 'td': 1.16483576497}}, 'avg': 1.1700655142343173}, 4: {'wires': {50: {'index': 8, 'td': 1.18104517351}, 46: {'index': 5, 'td': 1.15379684549}, 54: {'index': 2, 'td': 1.14248633158}}, 'avg': 1.15852737853995}}, '4': {8: {'wires': {15: {'index': 2, 'td': 1.47166016375}, 47: {'index': 1, 'td': 1.44287064135}, 31: {'index': 3, 'td': 1.50688474552}}, 'avg': 1.4698799012050645}, 16: {'wires': {15: {'index': 2, 'td': 1.8944275721}, 31: {'index': 3, 'td': 1.96403761007}, 47: {'index': 1, 'td': 1.87334876594}}, 'avg': 1.8988201429377962}, 2: {'wires': {31: {'index': 3, 'td': 1.43854157414}, 47: {'index': 1, 'td': 1.39625072382}, 15: {'index': 2, 'td': 1.45327440265}}, 'avg': 1.4291152256681428}, 4: {'wires': {47: {'index': 1, 'td': 1.37418501442}, 31: {'index': 3, 'td': 1.42525844376}, 15: {'index': 2, 'td': 1.41033078388}}, 'avg': 1.400554275991986}}}


#Median seed:
res_dict = {'5': {8: {'wires': {153: {'index': 5, 'td': 1.24953298697}, 156: {'index': 6, 'td': 1.25822257215}, 54: {'index': 7, 'td': 1.26418172796}}, 'avg': 1.25400864762788}, 16: {'wires': {153: {'index': 5, 'td': 1.4719501883}, 156: {'index': 6, 'td': 1.53233393149}, 54: {'index': 7, 'td': 1.51451475716}}, 'avg': 1.5083576235940248}, 2: {'wires': {153: {'index': 5, 'td': 1.28036596947}, 156: {'index': 6, 'td': 1.24140995485}, 54: {'index': 7, 'td': 1.28712196783}}, 'avg': 1.2741892397480743}, 4: {'wires': {153: {'index': 5, 'td': 1.24632330675}, 156: {'index': 6, 'td': 1.22532322148}, 54: {'index': 7, 'td': 1.23392839402}}, 'avg': 1.2369563706772473}}, '3.0': {8: {'wires': {15: {'index': 3, 'td': 1.56288814455}, 14: {'index': 4, 'td': 1.58167683778}, 47: {'index': 1, 'td': 1.51804055167}}, 'avg': 1.5551601717607073}, 16: {'wires': {15: {'index': 3, 'td': 2.15739825885}, 14: {'index': 4, 'td': 2.30315529377}, 47: {'index': 1, 'td': 2.20448152145}}, 'avg': 2.208413593828967}, 2: {'wires': {15: {'index': 3, 'td': 1.46353896196}, 14: {'index': 4, 'td': 1.49463023716}, 47: {'index': 1, 'td': 1.46682699152}}, 'avg': 1.4702154455888552}, 4: {'wires': {47: {'index': 1, 'td': 1.40033186897}, 14: {'index': 4, 'td': 1.45716192608}, 15: {'index': 3, 'td': 1.4607652257}}, 'avg': 1.440658795300829}}, '7': {8: {'wires': {56: {'index': 5, 'td': 1.3491864399}, 164: {'index': 4, 'td': 1.33713661894}, 55: {'index': 3, 'td': 1.3471202399}}, 'avg': 1.3447524606749617}, 16: {'wires': {56: {'index': 5, 'td': 1.64254948313}, 164: {'index': 4, 'td': 1.56010788161}, 55: {'index': 3, 'td': 1.57397987742}}, 'avg': 1.589029418215507}, 2: {'wires': {56: {'index': 5, 'td': 1.33556639179}, 164: {'index': 4, 'td': 1.36526502535}, 55: {'index': 3, 'td': 1.42824552632}}, 'avg': 1.3688692265096538}, 4: {'wires': {56: {'index': 5, 'td': 1.31701828241}, 164: {'index': 4, 'td': 1.31639201617}, 55: {'index': 3, 'td': 1.33886675286}}, 'avg': 1.3205729783033706}}, '16': {8: {'wires': {249: {'index': 2, 'td': 1.67752230269}, 155: {'index': 3, 'td': 1.68885272311}, 78: {'index': 1, 'td': 1.65788790831}}, 'avg': 1.6844414316913907}, 16: {'wires': {249: {'index': 2, 'td': 1.83737960378}, 155: {'index': 3, 'td': 1.83462291374}, 78: {'index': 1, 'td': 1.81954658807}}, 'avg': 1.8349935275461167}, 2: {'wires': {249: {'index': 2, 'td': 1.68223349466}, 155: {'index': 3, 'td': 1.72526885936}, 78: {'index': 1, 'td': 1.69665579363}}, 'avg': 1.698468299061625}, 4: {'wires': {249: {'index': 2, 'td': 1.66282271968}, 155: {'index': 3, 'td': 1.67965865883}, 78: {'index': 1, 'td': 1.66506453662}}, 'avg': 1.6715366739047253}}, '3.1': {8: {'wires': {50: {'index': 8, 'td': 1.26993479486}, 46: {'index': 5, 'td': 1.2454493048}, 54: {'index': 2, 'td': 1.24795758298}}, 'avg': 1.2557347729791806}, 16: {'wires': {50: {'index': 8, 'td': 1.72641729797}, 54: {'index': 2, 'td': 1.72595617589}, 46: {'index': 5, 'td': 1.75143944265}}, 'avg': 1.7367131637270476}, 2: {'wires': {50: {'index': 8, 'td': 1.21817605404}, 54: {'index': 2, 'td': 1.18208604417}, 46: {'index': 5, 'td': 1.20514836689}}, 'avg': 1.2006443422735944}, 4: {'wires': {50: {'index': 8, 'td': 1.19559126216}, 46: {'index': 5, 'td': 1.17603937763}, 54: {'index': 2, 'td': 1.16219652399}}, 'avg': 1.1765240373638155}}, '4': {8: {'wires': {15: {'index': 2, 'td': 1.5031976329}, 47: {'index': 1, 'td': 1.46407120758}, 31: {'index': 3, 'td': 1.52381574282}}, 'avg': 1.4962279569324441}, 16: {'wires': {15: {'index': 2, 'td': 1.92668613327}, 31: {'index': 3, 'td': 1.99919633206}, 47: {'index': 1, 'td': 1.91872667696}}, 'avg': 1.9319772497233678}, 2: {'wires': {31: {'index': 3, 'td': 1.47156294098}, 47: {'index': 1, 'td': 1.44406465693}, 15: {'index': 2, 'td': 1.49766849114}}, 'avg': 1.4691270580610463}, 4: {'wires': {47: {'index': 1, 'td': 1.40181005792}, 31: {'index': 3, 'td': 1.45555126334}, 15: {'index': 2, 'td': 1.43711853377}}, 'avg': 1.4221942714589006}}}

colors = plt.cm.get_cmap("Set1")
xs = [1.2, 2.2, 3.2, 4.2, 5.2, 6.2]
Ns = [2, 4, 8, 16]
markers = ["o", "s", "^", "p"]
techs = ["16", "7", "5", "4", "3.0", "3.1"]

def plot_N(N, tech, data, label, avg = False):
    x = xs[techs.index(tech)] + Ns.index(N) * 0.16
    if not avg:
        for wire in data["wires"]:
            y = data["wires"][wire]["td"]
            plt.scatter(x, y, marker = markers[Ns.index(N)], c = colors(Ns.index(N) / float(len(Ns))), label= ("N = %d" % N) if label else None)
            plt.text(x, y, str(data["wires"][wire]["index"]), color="black", fontsize=8)
            label = False
    else:
        plt.scatter(x, data["avg"], marker = markers[Ns.index(N)], c = colors(Ns.index(N) / float(len(Ns))), label = ("N = %d" % N) if label else None)

N2 = [1.68, 1.38, 1.28, 1.45, 1.49, 1.20]
N4 = [1.64, 1.34, 1.21, 1.37, 1.46, 1.16]
N8 = [1.65, 1.35, 1.22, 1.44, 1.54, 1.26]
N16 = [1.81, 1.60, 1.47, 1.89, 2.13, 1.71]


xticklabels = ["F16", "F7", "F5", "F4", "F3a", "F3b"]

for t, tech in enumerate(techs):
    tech_xs = np.array([xs[t] + Ns.index(N) * 0.16 for N in Ns])
    tech_ys = np.array([res_dict[tech][N]["avg"] for N in Ns])
    x_new = np.linspace(tech_xs.min(), tech_xs.max(),500)
    f = interp1d(tech_xs, tech_ys, kind='quadratic')
    y_smooth=f(x_new)
    plt.plot(x_new,y_smooth, c='gray', zorder = 0, lw = 1)

labeled = False
for tech in techs:
    for N in reversed(Ns):
        plot_N(N, tech, res_dict[tech][N], label = not labeled, avg = True)
    labeled = True

plt.xticks([x + 0.24 for x in xs], xticklabels)
plt.xlim(0.7, 7)
plt.xlabel("Technology node")
plt.ylabel("[ns]")
plt.ylim(1.1, 2.3)

plt.legend()
plt.savefig("fig_15_avg.pdf")
